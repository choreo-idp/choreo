# customizing the envoy gateway configurations
gateway:
  enabled: true
  config:
    envoyGateway:
      rateLimit:
        backend:
          type: Redis
          redis:
            url: redis.choreo-system.svc.cluster.local:6379
  # -- Resource limits and requests for the gateway
  deployment:
    envoyGateway:
      resources:
        limits:
          cpu: 200m
          memory: 256Mi
        requests:
          cpu: 100m
          memory: 128Mi

# Redis configuration for gateway rate limiting
redis:
  enabled: true
  image:
    repository: redis
    tag: "6.0.6"
    pullPolicy: IfNotPresent
  
  resources:
    limits:
      cpu: 100m
      memory: 256Mi
    requests:
      cpu: 50m
      memory: 128Mi
  
  service:
    port: 6379

# customizing the cert-manager configurations
certmanager:
  enabled: false
  crds:
    enabled: true
  # -- Resource limits and requests for the cert-manager controller
  resources:
    requests:
      cpu: 10m
      memory: 32Mi
    limits:
      cpu: 50m
      memory: 64Mi
  cainjector:
    # -- Resource limits and requests for the cert-manager cainjector
    resources:
      requests:
        cpu: 10m
        memory: 32Mi
      limits:
        cpu: 50m
        memory: 64Mi
  webhook:
    # -- Resource limits and requests for the cert-manager webhook
    resources:
      requests:
        cpu: 10m
        memory: 32Mi
      limits:
        cpu: 50m
        memory: 64Mi

# Customizing overall observability configurations
observability:
  logging:
    enabled: true

# Customizing OpenSearch configurations
opensearch:
  image:
    repository: opensearchproject/opensearch
    tag: "2.11.0"
    pullPolicy: IfNotPresent
  
  service:
    type: NodePort
    httpPort: 9200
    transportPort: 9300
    nameSuffix: "opensearch"
    # NodePort configuration for cross-cluster access
    nodePort: 30920  # Fixed port for external access from other clusters
  
  config:
    clusterName: opensearch-cluster
    discoveryType: single-node
    javaOpts: "-Xms512m -Xmx512m"
    memoryLock: false
    disableSecurity: true
  
  credentials:
    username: admin
    password: admin
  
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 512Mi
  
  persistence:
    enabled: true
    storageClass: ""
    accessMode: ReadWriteOnce
    size: 5Gi
  
  replicas: 1

# Customizing OpenSearch Dashboards configurations
opensearchDashboard:
  image:
    repository: opensearchproject/opensearch-dashboards
    tag: "2.11.0"
    pullPolicy: IfNotPresent
  
  service:
    type: NodePort
    port: 5601
    nameSuffix: "opensearch-dashboard"
  
  config:
    disableSecurity: true
  
  replicas: 1

# Choreo Observer Service Configuration
observer:
  replicas: 1
  
  image:
    repository: ghcr.io/openchoreo/observer
    tag: latest-dev
    pullPolicy: IfNotPresent
  
  service:
    type: ClusterIP
    port: 8080
  
  opensearch:
    # References the OpenSearch configuration above
    # address: constructed in observer-deployment.yaml template
    username: "{{ .Values.opensearch.credentials.username }}"
    password: "{{ .Values.opensearch.credentials.password }}"
  
  logLevel: info
  
  resources:
    limits:
      cpu: 500m
      memory: 256Mi
    requests:
      cpu: 100m
      memory: 128Mi